---
status: accepted
date: 2026-02-07
decision-makers: []
---

# ADR-0001: モノレポ構成（BE/FE分離、共有コードなし）

## コンテキストと課題

Rails APIバックエンドとNext.jsフロントエンドの2つのアプリケーションを開発するにあたり、リポジトリ構成を決定する必要があった。devcontainerで開発環境を統一する前提があり、開発体験・デプロイ容易性・コードの独立性を考慮した。

## 検討した選択肢

### 選択肢1: モノレポ・共有コードなし

`be/` と `fe/` を同一リポジトリに配置するが、共有パッケージは設けない。各アプリケーションは完全に独立したコードベースとして管理する。

- 良い点: 構成がシンプル、devcontainerで一括管理可能、独立デプロイ可能、共有コードの同期問題が発生しない
- 悪い点: 型定義やユーティリティの共有ができない

### 選択肢2: リポジトリ分離

バックエンドとフロントエンドを別々のリポジトリで管理する。

- 良い点: 各チームが独立して開発可能、CI/CDが独立
- 悪い点: devcontainerでの一括管理が困難、リポジトリ間の変更同期が煩雑、開発環境のセットアップが二重になる

### 選択肢3: モノレポ・共有パッケージあり（turborepo等）

turborepoやnx等のツールを使い、共有パッケージ（型定義・ユーティリティ等）を管理する。

- 良い点: フロントエンドとバックエンド間で型定義を共有可能
- 悪い点: ビルドツールの追加導入が必要、RailsとNode.jsの混在でツールチェーンが複雑化、小規模プロジェクトにはオーバーキル

## 決定

**選択肢1: モノレポ・共有コードなし** を採用する。

バックエンド（Rails）とフロントエンド（Next.js）は言語もランタイムも異なるため、共有コードの必要性が低い。JSON APIを介した疎結合な設計により、各アプリケーションの独立性を保ちながらdevcontainerで一括管理できるシンプルな構成を選んだ。

## 結果

### 良い影響

- `docker-compose.yaml` 一つで開発環境全体を管理できる
- 各アプリケーションを独立してビルド・テスト・デプロイできる
- コードベースの境界が明確で、責務の分離が自然に保たれる

### 悪い影響

- APIレスポンスの型定義はフロントエンド側で別途定義が必要
- バックエンドのスキーマ変更時にフロントエンド側の手動更新が必要

## 補足

- ディレクトリ構成: `be/`（Rails 8.1）、`fe/`（Next.js 16）
- devcontainer構成: `.devcontainer/compose.yaml` で単一サービスとしてオーケストレーション
- 関連ADR: [ADR-0006](0006-devcontainer-development-environment.md)
